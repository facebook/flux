<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Flux | Application Architecture for Building User Interfaces</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Flux | Application Architecture for Building User Interfaces"><meta property="og:type" content="website"><meta property="og:url" content="http://facebook.github.io/flux/index.html"><meta property="og:description" content="Application Architecture for Building User Interfaces"><link rel="stylesheet" href="/flux/css/flux.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/flux/"><img class="nav-logo" src="/flux/img/flux_logo.svg" width="50" height="50">Flux</a><ul class="nav-site"><li><a href="/flux/docs/overview.html#content" class="active">docs</a></li><li><a href="/flux/support.html" class="">support</a></li><li><a href="http://github.com/facebook/flux" class="">github</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/flux/docs/overview.html#content">Overview</a></li><li><a style="margin-left:0;" class="" href="/flux/docs/todo-list.html#content">Tutorial – Todo List</a></li><li><a style="margin-left:0;" class="" href="/flux/docs/chat.html#content">Tutorial – Chat</a></li></ul></div><div class="nav-docs-section"><h3>Guides</h3><ul><li><a style="margin-left:0;" class="" href="/flux/docs/actions-and-the-dispatcher.html#content">Actions and the Dispatcher</a></li><li><a style="margin-left:0;" class="" href="/flux/docs/testing-flux-applications.html#content">Testing Flux Applications</a></li></ul></div><div class="nav-docs-section"><h3>Reference</h3><ul><li><a style="margin-left:0;" class="" href="/flux/docs/dispatcher.html#content">Dispatcher</a></li><li><a style="margin-left:0;" class="" href="/flux/docs/flux-utils.html#content">Flux Utils</a></li></ul></div><div class="nav-docs-section"><h3>Community Resources</h3><ul><li><a style="margin-left:0;" class="" href="/flux/docs/videos.html#content">Videos</a></li><li><a style="margin-left:0;" class="" href="/flux/docs/examples-and-tools.html#content">Examples and Tools</a></li></ul></div><div class="nav-docs-section"><h3>Complementary</h3><ul><li><a target="_blank" style="margin-left:0;" class="" href="http://facebook.github.io/react/">React – UI Library</a></li><li><a target="_blank" style="margin-left:0;" class="" href="http://facebook.github.io/immutable-js/">ImmutableJS – Immutable Data</a></li><li><a target="_blank" style="margin-left:0;" class="" href="http://facebook.github.io/jest/">Jest – Unit Testing</a></li></ul></div></div><div class="inner-content"><a id="content"></a><h1>Dispatcher</h1><div><p>Dispatcher는 등록된 callback에 데이터를 중계할 때 사용된다. 일반적인 pub-sub 시스템과는 다음 두 항목이 다르다:</p><ul><li>콜백은 이벤트를 개별적으로 구독하지 않는다. 모든 데이터 변동은 등록된 모든 콜백에 전달된다.</li><li>콜백이 실행될 때 콜백의 전체나 일부를 중단할 수 있다.</li></ul><p>소스 코드를 보려면 <a href="https://github.com/facebook/flux/blob/master/src/Dispatcher.js" target="_blank">Dispatcher.js</a>에서 확인할 수 있다.</p><h2><a class="anchor" name="api"></a>API <a class="hash-link" href="#api">#</a></h2><ul><li><p><strong>register(function callback): string</strong>
모든 데이터 변동이 있을 때 실행될 콜백을 등록한다. <code>waitFor()</code>에서 사용 가능한 토큰을 반환한다.</p></li><li><p><strong>unregister(string id): void</strong>
토큰으로 콜백을 제거한다.</p></li><li><p><strong>waitFor(array&lt;string&gt; ids): void</strong>
현재 실행한 콜백이 진행되기 전에 특정 콜백을 지연하게 한다. 데이터 변동에 응답하는 콜백에만 사용해야 한다.</p></li><li><p><strong>dispatch(object payload): void</strong> 등록된 모든 콜백에 데이터를 전달한다.</p></li><li><p><strong>isDispatching(): boolean</strong> 이 Dispatcher가 지금 데이터를 전달하고 있는지 확인한다.</p></li></ul><h2><a class="anchor" name=""></a>예시 <a class="hash-link" href="#">#</a></h2><p>가상의 비행 목적지 양식에서 국가를 선택했을 때 기본 도시를 선택하는 예를 보자:</p><div class="prism language-javascript"><span class="token keyword">var</span> flightDispatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// 어떤 국가를 선택했는지 계속 추적한다
</span><span class="token keyword">var</span> CountryStore <span class="token operator">=</span> <span class="token punctuation">{</span>country<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// 어느 도시를 선택했는지 계속 추적한다
</span><span class="token keyword">var</span> CityStore <span class="token operator">=</span> <span class="token punctuation">{</span>city<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// 선택된 도시의 기본 항공료를 계속 추적한다
</span><span class="token keyword">var</span> FlightPriceStore <span class="token operator">=</span> <span class="token punctuation">{</span>price<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div><p>사용자가 선택한 도시를 변경하면 데이터를 전달한다:</p><div class="prism language-javascript">flightDispatcher<span class="token punctuation">.</span><span class="token function">dispatch<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  actionType<span class="token punctuation">:</span> <span class="token string">&#x27;city-update&#x27;</span><span class="token punctuation">,</span>
  selectedCity<span class="token punctuation">:</span> <span class="token string">&#x27;paris&#x27;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>이 데이터 변동은 <code>CityStore</code>가 소화한다:</p><div class="prism language-javascript">flightDispatcher<span class="token punctuation">.</span><span class="token function">register<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>actionType <span class="token operator">===</span> <span class="token string">&#x27;city-update&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    CityStore<span class="token punctuation">.</span>city <span class="token operator">=</span> payload<span class="token punctuation">.</span>selectedCity<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>사용자가 국가를 선택하면 데이터를 전달한다:</p><div class="prism language-javascript">flightDispatcher<span class="token punctuation">.</span><span class="token function">dispatch<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  actionType<span class="token punctuation">:</span> <span class="token string">&#x27;country-update&#x27;</span><span class="token punctuation">,</span>
  selectedCountry<span class="token punctuation">:</span> <span class="token string">&#x27;australia&#x27;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>이 데이터는 두 store에 의해 소화된다:</p><div class="prism language-javascript"> CountryStore<span class="token punctuation">.</span>dispatchToken <span class="token operator">=</span> flightDispatcher<span class="token punctuation">.</span><span class="token function">register<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>actionType <span class="token operator">===</span> <span class="token string">&#x27;country-update&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    CountryStore<span class="token punctuation">.</span>country <span class="token operator">=</span> payload<span class="token punctuation">.</span>selectedCountry<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p><code>CountryStore</code>가 등록한 콜백을 업데이트 할 때 반환되는 토큰을 참조값으로 저장했다. 이 토큰은 <code>waitFor()</code>
에서 사용할 수 있고 <code>CityStore</code>가 갱신하는 것보다 먼저 <code>CountryStore</code>를 갱신하도록 보장할 수 있다.</p><div class="prism language-javascript">CityStore<span class="token punctuation">.</span>dispatchToken <span class="token operator">=</span> flightDispatcher<span class="token punctuation">.</span><span class="token function">register<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>actionType <span class="token operator">===</span> <span class="token string">&#x27;country-update&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true"> // `CountryStore.country`는 업데이트 되지 않는다
</span>    flightDispatcher<span class="token punctuation">.</span><span class="token function">waitFor<span class="token punctuation">(</span></span><span class="token punctuation">[</span>CountryStore<span class="token punctuation">.</span>dispatchToken<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true"> // `CountryStore.country`는 업데이트가 될 수 있음이 보장되었다
</span>
   <span class="token comment" spellcheck="true"> // 새로운 국가의 기본 도시를 선택한다
</span>    CityStore<span class="token punctuation">.</span>city <span class="token operator">=</span> <span class="token function">getDefaultCityForCountry<span class="token punctuation">(</span></span>CountryStore<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p><code>waitFor()</code>는 다음과 같이 묶을 수 있다:</p><div class="prism language-javascript">FlightPriceStore<span class="token punctuation">.</span>dispatchToken <span class="token operator">=</span>
  flightDispatcher<span class="token punctuation">.</span><span class="token function">register<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    switch <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>actionType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      case <span class="token string">&#x27;country-update&#x27;</span><span class="token punctuation">:</span>
      case <span class="token string">&#x27;city-update&#x27;</span><span class="token punctuation">:</span>
        flightDispatcher<span class="token punctuation">.</span><span class="token function">waitFor<span class="token punctuation">(</span></span><span class="token punctuation">[</span>CityStore<span class="token punctuation">.</span>dispatchToken<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        FlightPriceStore<span class="token punctuation">.</span>price <span class="token operator">=</span>
          <span class="token function">getFlightPriceStore<span class="token punctuation">(</span></span>CountryStore<span class="token punctuation">.</span>country<span class="token punctuation">,</span> CityStore<span class="token punctuation">.</span>city<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div><p><code>country-update</code>는 콜백이 등록된 순서 즉 <code>CountryStore</code>, <code>CityStore</code>, <code>FlightPriceStore</code> 순서로 실행되도록 보장된다.</p></div><div class="docs-prevnext"><a class="docs-next" href="videos-ko-KR.html#content">Next →</a></div></div></section><footer class="wrap"><div class="right">© 2014-2016 Facebook Inc.</div></footer></div><div id="fb-root"></div><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-387204-10', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          </script></body></html>